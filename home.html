<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FoodLens - Smart Food Scanner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="home.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="#"><i class="fas fa-camera rotating-lens"></i> FoodLens</a>
    </div>
  </nav>

  <section class="hero">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-7">
          <h1 class="display-4 fw-bold fade-in">Understand what's in<br><span class="text-primary">your food</span></h1>
          <p class="lead mt-3 slide-up">Scan, search, and discover detailed nutrition insights. Make informed decisions about what you eat with FoodLens.</p>
          <div class="search-container mt-4 zoom-in">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Search for any food..." id="foodInput">
              <div class="search-actions">
                <button class="btn btn-primary search-btn" title="Search"><i class="fas fa-search"></i></button>
                <button class="btn btn-primary scan-btn" title="Scan Barcode"><i class="fas fa-barcode"></i></button>
              </div>
            </div>
            <p class="text-muted mt-2"><i class="fas fa-bolt"></i> Quick scan: Try searching "apple" or "Lays"</p>
          </div>
        </div>
        <div class="col-lg-5">
          <div class="hero-image floating">
            <img src="basket.png" alt="Food analysis" width="1000" height="1000" class="img-fluid">
            <div class="stat-card protein">
              <span>PROTEIN</span>
              <strong>24g</strong>
            </div>
            <div class="stat-card calories">
              <span>CALORIES</span>
              <strong>320</strong>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="features py-5">
    <div class="container">
      <h2 class="text-center display-5 mb-3 fade-in">Everything you need to know about your food</h2>
      <p class="text-center text-muted mb-5 slide-up">FoodLens provides comprehensive nutrition analysis at your fingertips</p>
      <div class="row g-4">
        <div class="col-md-4">
          <div class="feature-card zoom-in">
            <div class="feature-icon purple mb-3 floating-icon">
              <i class="fas fa-clock"></i>
            </div>
            <h3>Nutritional Analysis</h3>
            <p class="text-muted">Get detailed breakdown of calories, macronutrients, vitamins, and minerals.</p>
            <div class="nutrition-stats">
              <div class="stat-row">
                <span>Protein</span>
                <span class="purple">24g</span>
              </div>
              <div class="stat-row">
                <span>Carbs</span>
                <span class="purple">45g</span>
              </div>
              <div class="stat-row">
                <span>Fats</span>
                <span class="purple">12g</span>
              </div>
              <div class="stat-row">
                <span>Fiber</span>
                <span class="purple">8g</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card zoom-in">
            <div class="feature-icon purple mb-3 floating-icon">
              <i class="fas fa-chart-bar"></i>
            </div>
            <h3>Ultra-Processing Detection</h3>
            <p class="text-muted">Understand the level of processing in your food and its health implications.</p>
            <div class="processing-meter">
              <div class="meter-labels">
                <span>Minimal</span>
                <span>Moderate</span>
                <span>High</span>
              </div>
              <div class="meter-bar">
                <div class="meter-progress" style="width: 50%"></div>
              </div>
              <p class="processing-level">
                <i class="fas fa-info-circle"></i>
                Moderately processed
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card zoom-in">
            <div class="feature-icon purple mb-3 floating-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3>Allergen Detection</h3>
            <p class="text-muted">Identify potential allergens in your food and stay safe.</p>
            <div class="allergen-list">
              <div class="allergen-item contains">
                <i class="fas fa-times-circle"></i>
                Contains gluten
              </div>
              <div class="allergen-item may-contain">
                <i class="fas fa-exclamation-circle"></i>
                May contain traces of nuts
              </div>
              <div class="allergen-item safe">
                <i class="fas fa-check-circle"></i>
                No dairy
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="features py-5">
    <div class="container">
     <h2 class="text-center display-5 mb-3 fade-in">HOW IT WORKS</h2>
     <h3 class="text-center text-muted mb-3 slide-up">Simple steps to food transparency</h3>
     <p class="text-center text-muted mb-5 slide-up">Get detailed nutrition insights in seconds with our easy-to-use tools</p>
 
     <div class="row g-4">
       <div class="col-md-4">
         <div class="step-card zoom-in">
           <div class="step-number">1</div>
           <h4>Search or Scan</h4>
           <p>Type in a food name or scan a barcode with your camera for instant recognition.</p>
         </div>
       </div>
       <div class="col-md-4">
         <div class="step-card zoom-in">
           <div class="step-number">2</div>
           <h4>Review Details</h4>
           <p>Get comprehensive nutrition facts, processing level, and allergen information.</p>
         </div>
       </div>
       <div class="col-md-4">
         <div class="step-card zoom-in">
           <div class="step-number">3</div>
           <h4>Make Better Choices</h4>
           <p>Use insights to compare products and make informed decisions about your diet.</p>
         </div>
       </div>
     </div>
   </section>

   <section class="quotes py-5 bg-light" id="quotes">
    <div class="container">
      <div class="quote-container text-center">
        <h2 class="mb-4">Nutrition Wisdom</h2>
  
        <div id="quoteCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
          <div class="carousel-inner">
  
            <div class="carousel-item active">
              <p class="fs-4 fst-italic">"Let food be the medicine and medicine be the food."</p>
            </div>
  
            <div class="carousel-item">
              <p class="fs-4 fst-italic">"You are what you eat, so don’t be fast, cheap, easy, or fake."</p>
            </div>
  
            <div class="carousel-item">
              <p class="fs-4 fst-italic">"Take care of your body. It’s the only place you have to live."</p>
            </div>
  
            <div class="carousel-item">
              <p class="fs-4 fst-italic">"Eating well is a form of self-respect."</p>
            </div>
  
            <div class="carousel-item">
              <p class="fs-4 fst-italic">"The food you eat can be either the safest and most powerful form of medicine or the slowest form of poison."</p>
            </div>
  
          </div>
        </div>
  
      </div>
    </div>
  </section>
  

  <footer class="footer py-5">
    <div class="text-center mt-5">
      <button class="btn btn-light btn-lg">Try FoodLens Now</button>
    </div>
    <p class="text-center text-white-50 mt-5 mb-0">Developed by FoodLens Team © 2025</p>
  </footer>

  <div class="chatbot-icon">
    <button class="btn btn-primary rounded-circle" onclick="document.location.href='chatbot.html';">
      <i class="fas fa-robot"></i>
    </button>
  </div>

  <!-- QR Scanner Modal -->
  <div class="modal fade" id="qrScannerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-3">
        <div class="modal-header">
          <h5 class="modal-title">Scan Barcode / QR</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="stopScanner()"></button>
        </div>
        <div class="modal-body">
          <div id="reader" style="width: 100%;"></div>
          <p class="mt-3 text-success" id="qr-result"></p>
        </div>
      </div>
    </div>
  </div>
  <!-- Spinner Overlay -->
<div id="loadingOverlay" class="loading-overlay d-none">
  <div class="spinner-border text-primary" role="status"></div>
  <p class="mt-3 text-white">Loading...</p>
</div>


  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>

  <script>
    let html5QrCode;
const scanBtn = document.querySelector(".scan-btn");
const searchBtn = document.querySelector(".search-btn");
const inputField = document.querySelector("#foodInput");
const qrModalEl = document.getElementById("qrScannerModal");
const qrResult = document.getElementById("qr-result");
const bsModal = new bootstrap.Modal(qrModalEl);
function showLoader() {
  document.getElementById("loadingOverlay").classList.remove("d-none");
}
function hideLoader() {
  document.getElementById("loadingOverlay").classList.add("d-none");
}

// ✅ Common function for both QR and Search
function fetchAndShowFoodData(query) {
  showLoader();
  
  fetch(`http://localhost:5000/api/food?query=${encodeURIComponent(query)}`)
    .then((res) => res.json())
    .then((data) => {
      console.log("Food data:", data);
      if (data.error) {
        alert("❌ " + data.error);
        return;
      }

      // ✅ Store data in localStorage and redirect
      localStorage.setItem("foodData", JSON.stringify(data));
      window.location.href = "details.html";
    })
    .catch((err) => {
      console.error("Error fetching food data:", err);
      alert("Error fetching food data.");
    });
}

// 🔍 Search button click
searchBtn.addEventListener("click", () => {
  const query = inputField.value.trim();
  if (!query) {
    alert("Please enter a food name or barcode.");
    return;
  }
  fetchAndShowFoodData(query);
});

// 📷 QR Scan button click
scanBtn.addEventListener("click", () => {
  bsModal.show();
  html5QrCode = new Html5Qrcode("reader");

  const config = { fps: 10, qrbox: 250 };

  html5QrCode.start(
    { facingMode: "environment" },
    config,
    (decodedText) => {
      inputField.value = decodedText;
      qrResult.innerText = "Scanned: " + decodedText;

      html5QrCode.stop().then(() => {
        html5QrCode.clear();
        bsModal.hide();

        // 🔄 Fetch data just like search
        fetchAndShowFoodData(decodedText);
      });
    },
    (errorMessage) => {
      // Ignore scan errors
    }
  ).catch(err => {
    console.error("Camera error:", err);
  });
});

// ⛔ Stop scanner manually if needed
function stopScanner() {
  if (html5QrCode) {
    html5QrCode.stop().then(() => {
      html5QrCode.clear();
    }).catch(err => {
      console.error("Stop error:", err);
    });
  }
}

  </script>
  
 
</body>
</html>
